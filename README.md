# Go Hosts 

é¦–å…ˆå‘ SwitchHosts è‡´æ•¬ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½ç”¨çš„è½¯ä»¶ï¼Œè¿™ä¸ªè½¯ä»¶å’Œå®ƒä¸€æ ·éƒ½æ˜¯ç”¨æ¥ç®¡ç† hosts æ–‡ä»¶çš„ã€‚æ”¯æŒ **Windows** å’Œ **macOS**ï¼ˆIntelï¼‰ã€‚

Go Hosts ä½¿ç”¨ go + [fyne](https://fyne.io/) å¼€å‘ç­‰æŠ€æœ¯å¼€å‘ï¼Œä¼˜ç‚¹ä½“ç§¯å°ï¼Œæ”¯æŒè·¨å¹³å°ç¼–è¯‘æ‰“åŒ…ã€‚

## ä¸ºä»€ä¹ˆä¼šé‡å¤é€ è½®å­å‘¢ï¼Ÿ

SwitchHosts å¤ªå¤§äº†ï¼ˆElectronï¼‰ï¼Œä¸å¤ªçµæ´»ã€‚æˆ‘å¯¹å°å·¥å…·çš„æ‰§å¿µæŒºå¤§ï¼Œå°å·¥å…·å°±åº”è¯¥è¶³å¤Ÿå°ï¼ˆè™½ç„¶è¿˜æ˜¯ä¸å¤Ÿå°ğŸ˜Šï¼‰ã€‚

1. PING æµ‹è¯•ï¼Œå¿«é€Ÿæ‰¾åˆ°ç›®æ ‡ç½‘ç«™**æ‰€æœ‰IPåœ°å€**ï¼Œä¾‹å¦‚ github.comã€‚
2. TCP æµ‹è¯•ï¼Œå¿«é€Ÿæ‰¾åˆ°å½“å‰ç½‘ç»œç¯å¢ƒè¿æ¥æœ€å¿«çš„é‚£ä¸ªIPï¼Œé…ç½® hosts åŠ é€Ÿè®¿é—®ã€‚
3. æ”¯æŒæ‰©å±• cmd å‘½ä»¤èœå•ï¼ŒæŠŠç³»ç»Ÿä¸€äº›å¸¸ç”¨å·¥å…·çµ¦ä¸²èµ·æ¥
4. æˆ‘å°±æ˜¯ç©ï¼å“ˆå“ˆå“ˆ~

## å±å¹•æˆªå›¾

![é¦–é¡µ](doc/home.png)

![PING](doc/ping.png)

## åŠŸèƒ½

### åŸºç¡€åŠŸèƒ½

* å›¾å½¢åŒ–ç®¡ç† hosts è§„åˆ™ï¼ˆå¢ã€åˆ ã€æ”¹ã€åˆ·æ–°ï¼‰
* æ”¯æŒä¸€ä¸ª IP ç»‘å®šå¤šä¸ªåŸŸå
* æ”¯æŒä¸€ä¸ªåŸŸåç»‘å®šå¤šä¸ª IPï¼Œå¹¶å¯å¿«é€Ÿåˆ‡æ¢
* æ”¯æŒ Ping æµ‹è¯•ã€TCP æµ‹è¯•ã€ä¸»é¢˜åˆ‡æ¢ã€ç³»ç»Ÿæ‰˜ç›˜

### æ•°æ®ç±»å‹è¯´æ˜

* **IP ç±»å‹**ï¼šä¸€ä¸ª IP å¯¹åº”å¤šä¸ªåŸŸåï¼Œå¯åŒæ—¶å¯ç”¨å¤šä¸ªè§„åˆ™
* **Domain ç±»å‹**ï¼šä¸€ä¸ªåŸŸåå¯¹åº”å¤šä¸ª IPï¼ŒåŒä¸€æ—¶é—´åªå¯ç”¨ä¸€ä¸ª

## è¿›é˜¶åŠŸèƒ½

### Ping æµ‹è¯•

* é€šè¿‡åŸŸåè·å–å½“å‰ç½‘ç»œä¸‹å¯è®¿é—®çš„æ‰€æœ‰ IP
* ç”¨äºæ’æŸ¥è§£ææ…¢æˆ–è®¿é—®ä¸ç¨³å®šçš„é—®é¢˜

### TCP æµ‹é€Ÿ

* å¯¹å¤šä¸ª IP è¿›è¡Œå¹¶å‘ TCP æµ‹è¯•
* è‡ªåŠ¨é€‰å‡ºå½“å‰ç½‘ç»œæœ€å¿«çš„ IP

## è‡ªå®šä¹‰æŒ‰é’®ï¼ˆé«˜çº§ï¼‰

æ”¯æŒé€šè¿‡ YAML é…ç½®è‡ªå®šä¹‰æ“ä½œæŒ‰é’®ï¼Œç”¨äºæ‰§è¡Œç³»ç»Ÿæˆ–ç¬¬ä¸‰æ–¹å‘½ä»¤ã€‚

* æŒ‰é’®å¯æ˜¾ç¤ºåœ¨ç•Œé¢æˆ–ç³»ç»Ÿæ‰˜ç›˜
* æ”¯æŒå‚æ•°æ³¨å…¥ï¼Œå‚æ•°æ³¨å…¥ä½¿ç”¨ `%s`
* å‘½ä»¤ä¸­æ¶‰åŠè·¯å¾„è¦å†™åæ–œæ  "/"
* æœ¬è´¨æ˜¯ cmd æ‰©å±•ï¼Œé€‚ç”¨äºä»»ä½•å¯å‘½ä»¤è¡Œæ“ä½œçš„è½¯ä»¶
* æŸ¥çœ‹æ”¯æŒçš„ [fyne icon](https://docs.fyne.io/explore/icons/)

### ç¤ºä¾‹

#### Window config.yaml

```yaml
cus_buttons:
  - name: "åˆ·æ–° DNS"
    icon: "ViewRefreshIcon"
    cmd: "ipconfig /flushdns"

  - name: "æ‰“å¼€é…ç½®"
    cmd: "cmd /c start %USERPROFILE%/.GoHosts"

  - name: "æ‰“å¼€ hosts æ–‡ä»¶"
    cmd: "notepad C:/Windows/System32/drivers/etc/hosts"

  # è‹¥éœ€è¦è¾“å…¥æ¡†æ³¨å…¥å‚æ•°ä½¿ç”¨ %s å¯ä»¥æ³¨å…¥è¾“å…¥çš„å‚æ•°
  - name: "ç«¯å£æ‰«æ"
    cmd: "fscan -h %s"

  - name: "æ³¨å†Œè¡¨"
    icon: "ListIcon"
    cmd: "cmd /c regedit"

  - name: "æ§åˆ¶é¢æ¿"
    cmd: "control"

  - name: "ç½‘ç»œè¿æ¥"
    cmd: "cmd /c ncpa.cpl"
```

## å¼€å‘ & æ‰“åŒ…

> [!IMPORTANT]
> Mac åº”è¯¥æ˜¯æœ‰é™æ”¯æŒï¼Œä¸ºäº†æ”¯æŒ `Mac 10.15.x`ï¼Œ`fyne@v2.5.3`+`go 1.20`ã€‚
> è½¯ä»¶æ•°æ®ç›®å½• windowï¼š `%USERPROFILE%/.GoHosts`ï¼Œmac: `~/.GoHosts`ã€‚


1. å®‰è£… go å¹¶é…ç½®ç¯å¢ƒå˜é‡
2. å®‰è£… [tdm-gcc](https://jmeubank.github.io/tdm-gcc/download/)
3. å®‰è£… fyne 
    ```shell
    go install fyne.io/fyne/v2/cmd/fyne@latest
    ```

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ‰“åŒ…ï¼š

```shell
go mod tidy
# æ‰“åŒ… Window
fyne package -os windows
# æ‰“åŒ… Mac 
fyne package -os darwin
```

## æ³¨æ„äº‹é¡¹

### MacOS æƒé™é—®é¢˜

> [!IMPORTANT]
> MacOS éœ€ä¿®æ”¹ hosts æƒé™å¦åˆ™æ— æ³•å†™å…¥

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¿®æ”¹æƒé™

```shell
sudo chown $(whoami) /etc/hosts
# æˆ–
sudo chmod u+w /etc/hosts
```

### Cause: APIUnavailable: WGL: The driver does not appear to support OpenGL

[mesa3d å‘å¸ƒé¡µé¢](https://github.com/pal1000/mesa-dist-win/releases) ä¸‹è½½ [mesa3d](https://github.com/pal1000/mesa-dist-win/releases/download/25.3.3/mesa3d-25.3.3-release-msvc.7z)


1. è§£å‹ `mesa3d-25.3.3-release-msvc.7z`ã€‚
2. è¿è¡Œ `perappdeploy.cmd` åï¼Œå…¨éƒ¨æŒ‰å›è½¦é”®ã€‚
3. è¿è¡Œ `systemwidedeploy.cmd` åï¼Œè¾“å…¥ã€1ã€‘ç„¶åæŒ‰å›è½¦é”®ã€‚ï¼ˆåœ¨ `cmd` æ‰§è¡Œï¼Œä¸è¦ç›´æ¥åŒå‡»ï¼‰

## License

[Apache-2.0](https://spdx.org/licenses/Apache-2.0.html)
